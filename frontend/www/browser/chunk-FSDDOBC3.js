import{a as O}from"./chunk-SAQZAJ65.js";import{A as F,Aa as q,B as f,C as A,Ea as G,Fa as J,G as h,I as P,Ma as K,N as k,O as B,b as p,d as c,e as w,f as m,fa as j,g as L,h as S,j as u,k as I,l as b,n as D,na as V,o as x,p as s,pa as U,q as y,qa as H,ra as N,u as $,v as E,w as l,x as o,xa as z,y as a,z as M}from"./chunk-3L42HEHQ.js";import"./chunk-CLAHLS7V.js";import"./chunk-7OOC4MCY.js";import"./chunk-4G6E6OF5.js";import"./chunk-HY2EOBI2.js";import"./chunk-SZW6GDO7.js";import"./chunk-6OREKIDA.js";import"./chunk-4WFVMWDK.js";import"./chunk-K7C27B2F.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-DF3GZESY.js";import"./chunk-PVMEIX5M.js";import"./chunk-42C7ZIID.js";import{a as T,b as R,d as _}from"./chunk-JHI3MBHO.js";var C="/v1/relay",d=(()=>{class e extends O{getRelay(t){return this.getAppConfig().pipe(m(i=>{let r=new URL(`${i.api.host}${C}/${t}`);return this.httpClient.get(r.toString()).pipe(c(n=>(this.showToast("There was an error retrieving the relay!","danger"),p(()=>n))))}))}getRelays(){return this.getAppConfig().pipe(m(t=>{let i=new URL(`${t.api.host}${C}/`);return this.httpClient.get(i.toString()).pipe(c(r=>(this.showToast("There was an error getting the list of relays!","danger"),p(()=>r))))}))}updateRelay(t,i){return this.getAppConfig().pipe(m(r=>{let n=new URL(`${r.api.host}${C}/${t}`);return this.httpClient.put(n.toString(),i).pipe(L(()=>{this.showToast("Relay was updated sucessfully!","success")}),c(v=>(this.showToast("There was an error updating the relay!","danger"),p(()=>v))))}))}static \u0275fac=(()=>{let t;return function(r){return(t||(t=x(e)))(r||e)}})();static \u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var W=(()=>{class e{relayService=u(d);relay=B();refreshList=k();onRelayToggle(t){let n=this.relay(),{position:i}=n,r=_(n,["position"]);r=R(T({},r),{on:t.detail.checked}),this.relayService.updateRelay(this.relay().position,r).pipe(w(()=>{this.refreshList.emit()})).subscribe()}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=y({type:e,selectors:[["app-relay-tile"]],inputs:{relay:[1,"relay"]},outputs:{refreshList:"refreshList"},decls:3,vars:2,consts:[[3,"ionChange","checked"]],template:function(i,r){i&1&&(o(0,"ion-item")(1,"ion-toggle",0),f("ionChange",function(v){return r.onRelayToggle(v)}),h(2),a()()),i&2&&(s(),l("checked",r.relay().on),s(),P("Position ",r.relay().position))},dependencies:[j,N,K],encapsulation:2,changeDetection:0})}return e})();var X=(e,g)=>g.position;function Y(e,g){if(e&1){let t=F();o(0,"app-relay-tile",4),f("refreshList",function(){I(t);let r=A();return b(r.refreshList())}),a()}if(e&2){let t=g.$implicit;l("relay",t)}}var ge=(()=>{class e{relayService=u(d);relays=D([]);ionViewDidEnter(){this.refreshList()}refreshList(){this.relayService.getRelays().subscribe({next:t=>{this.relays.set(t)}})}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=y({type:e,selectors:[["app-relay-list"]],decls:10,vars:2,consts:[[3,"translucent"],["slot","start"],[3,"fullscreen"],[3,"relay"],[3,"refreshList","relay"]],template:function(i,r){i&1&&(o(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),M(3,"ion-menu-button"),a(),o(4,"ion-title"),h(5,"Relays"),a()()(),o(6,"ion-content",2)(7,"ion-list"),$(8,Y,1,1,"app-relay-tile",3,X),a()()),i&2&&(l("translucent",!0),s(6),l("fullscreen",!0),s(2),E(r.relays()))},dependencies:[H,J,V,q,G,U,z,W],encapsulation:2,changeDetection:0})}return e})();export{ge as RelayListPage};
